#!/bin/sh
# luajit wrapper that loads C libs from this dir and Lua libs from 2 dirs above.
# platform-specific Lua libs are loaded with priority from this dir.

# get full path of $0 without spawning a new process (this wrapper process is bad enough)
bindir="${0%luajit}"
curdir="$PWD"
cd "$bindir"
bindir="$PWD"
cd "$curdir"

luadir="$bindir/../.."                        # platform-indep. Lua modules
platform_dir="$bindir/lua"                    # platform-specific Lua modules

LD_LIBRARY_PATH="$bindir" \
LUA_CPATH="$bindir/clib/?.so" \
LUA_PATH="./?.lua;$platform_dir/?.lua;$luadir/?.lua;$luadir/?/init.lua" \
exec "$bindir/luajit-bin" "$@"
